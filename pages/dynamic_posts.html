<!DOCTYPE html>
<html>
<head>
    <title>ç›–æ¥¼åŠ¨æ€è¿›åº¦</title>
    <meta charset="utf-8">
    <script src="js/chart.umd.min.js"></script>
    <script src="js/chartjs-plugin-datalabels.min.js"></script>
    <script src="js/confetti.browser.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 40px;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8eb 100%);
            min-height: 100vh;
        }

        .header {
            width: 100%;
            background: linear-gradient(135deg, #1e88e5, #1565c0);
            color: white;
            text-align: center;
            padding: 40px 0;
            margin-bottom: 30px;
        }

        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .back-button {
            display: inline-block;
            padding: 12px 25px;
            background-color: #1e88e5;
            color: white;
            border: none;
            border-radius: 12px;
            text-decoration: none;
            margin-bottom: 30px;
            transition: all 0.3s ease;
            font-size: 16px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .back-button:hover {
            background-color: #1565c0;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .chart-container {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.05);
            margin-bottom: 30px;
            height: 550px;
            width: 100%;
        }

        .controls {
            margin: 30px 0;
            text-align: center;
        }

        .control-button {
            padding: 15px 30px;
            margin: 0 10px;
            background: #1e88e5;
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .control-button:hover {
            background: #1565c0;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .date-label {
            position: absolute;
            bottom: 80px;
            right: 80px;
            font-size: 86px;
            color: rgba(0,0,0,0.1);
            font-weight: bold;
            font-family: 'Arial', sans-serif;
        }

        .chart-wrapper {
            position: relative;
            height: 600px;
        }

        @keyframes rankChange {
            0% { transform: translateY(0); }
            50% { transform: translateY(10px); }
            100% { transform: translateY(0); }
        }

        .podium-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            opacity: 1;
            transition: opacity 0.5s ease-out;
        }

        .podium-overlay.fade-out {
            opacity: 0;
        }

        .podium-container {
            display: flex;
            align-items: flex-end;
            justify-content: center;
            padding: 20px;
            gap: 30px;
            margin-top: 300px;
            position: relative;
            z-index: 3;
        }

        .podium-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }

        .podium-base {
            width: 160px;
            position: relative;
            border-radius: 10px 10px 0 0;
        }

        .podium-step.gold .podium-base { 
            height: 300px; 
            background: linear-gradient(135deg, #FFD700, #FFA000);
        }
        .podium-step.silver .podium-base { 
            height: 250px; 
            background: linear-gradient(135deg, #C0C0C0, #9E9E9E);
        }
        .podium-step.bronze .podium-base { 
            height: 200px; 
            background: linear-gradient(135deg, #CD7F32, #8D6E63);
        }

        .podium-block {
            width: 140px;
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 20px;
        }

        .winner-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            margin-bottom: 10px;
            border: 6px solid white;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }

        .winner-name {
            color: white;
            font-size: 20px;
            font-weight: bold;
            text-align: center;
            margin-top: 10px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        .winner-score {
            color: white;
            font-size: 16px;
            margin-top: 5px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        .celebration-item {
            position: absolute;
            font-size: 60px;
            animation: float 3s infinite;
            z-index: 3;
        }

        .celebration-group {
            position: relative;
            width: 800px;
            height: 600px;
            margin-top: 200px;
        }

        @keyframes float {
            0%, 100% { 
                transform: translate(0, 0); 
                opacity: 0.8;
            }
            50% { 
                transform: translate(var(--x, 20px), var(--y, -20px)); 
                opacity: 1;
            }
        }

        .close-podium {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            font-size: 24px;
            cursor: pointer;
            padding: 10px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s ease;
        }

        .close-podium:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .confetti-container {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2;
        }

        .celebration-container {
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: 3;
            pointer-events: none;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .award-button {
            display: none;  /* åˆå§‹éšè— */
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(145deg, #FFD700, #FFA500);
            border: none;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            cursor: pointer;
            z-index: 999;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .award-button:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }
        
        .award-button::before {
            content: "ğŸ†";
            font-size: 24px;
            line-height: 60px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ç›–æ¥¼åŠ¨æ€è¿›åº¦</h1>
    </div>
    <button class="award-button" title="æŸ¥çœ‹é¢å¥–å°"></button>

    <div class="container">
        <a href="../index.html" class="back-button">è¿”å›é¦–é¡µ</a>

        <div class="chart-wrapper">
            <div class="chart-container">
                <canvas id="rankingChart"></canvas>
            </div>
            <div id="dateLabel" class="date-label"></div>
        </div>
        <div class="controls">
            <button class="control-button" onclick="startAnimation()">æ’­æ”¾</button>
            <button class="control-button" onclick="pauseAnimation()">æš‚åœ</button>
            <button class="control-button" onclick="resetAnimation()">é‡ç½®</button>
        </div>
    </div>

    <div class="podium-overlay">
        <div class="close-podium">Ã—</div>
        <div class="confetti-container"></div>
        <div class="celebration-container">
            <div class="celebration-group">
                <div class="celebration-item" style="top: 40%; left: -120px; --x: 30px; --y: -20px;">ğŸ‰</div>
                <div class="celebration-item" style="top: 60%; left: -80px; --x: 20px; --y: -30px;">ğŸ†</div>
                
                <div class="celebration-item" style="top: 40%; right: -120px; --x: -30px; --y: -20px;">ğŸŠ</div>
                <div class="celebration-item" style="top: 60%; right: -80px; --x: -20px; --y: -30px;">ğŸ’¥</div>
                
            </div>
        </div>
        <div class="podium-container">
            <div class="podium-step silver">
                <div class="podium-block">
                    <img class="winner-avatar" src="" alt="2nd Place">
                    <div class="winner-name"></div>
                    <div class="winner-score"></div>
                </div>
                <div class="podium-base"></div>
            </div>
            <div class="podium-step gold">
                <div class="podium-block">
                    <div class="crown" style="font-size: 60px;">ğŸ‘‘</div>
                    <img class="winner-avatar" src="" alt="1st Place">
                    <div class="winner-name"></div>
                    <div class="winner-score"></div>
                </div>
                <div class="podium-base"></div>
            </div>
            <div class="podium-step bronze">
                <div class="podium-block">
                    <img class="winner-avatar" src="" alt="3rd Place">
                    <div class="winner-name"></div>
                    <div class="winner-score"></div>
                </div>
                <div class="podium-base"></div>
            </div>
        </div>
    </div>

    <script>
        const rankingsData = [{"date": "2025-01-01 00:00:00", "rankings": [[130294434, 81, "\u53f8\u547d\u2601"], [256060645, 68, "0UXDeNA"], [284179257, 62, "MOMO2.0"], [212945898, 52, "\u70b9\u89e3\u70b9\u89e3DJ"], ["pixiaodan", 49, "\u516d\u6247\u95e8\u5185\u674e\u94f6\u5fc3"], [260295198, 45, "\u5c0f\u624b\u7231\u73a9"], [231193411, 39, "\u5c0f\u5976\u8c46"], [282998964, 38, "\ud80c\udda1\ud80c\udd9d\ud80c\udd9f\ud80c\udd9c\ud80c\udd9e\ud80c\udd9f"], [278142675, 36, "\u864emo"], [243090410, 31, "momo"], [70348459, 28, "\u4f36\u4ec3\u7ed9\u4f60\u8bfa"], [260322814, 26, "FoFo"], [261080295, 23, "underdog"], [143523138, 21, "\u5984\u7559WL"], [275997314, 21, "\u9ea6\u8150\u5224\u5b98"], [284411948, 18, "\u597d\u597d\u597d"], [189480748, 17, "Nothing"], [279804730, 16, "momo"], [237972257, 15, "\u968f\u610f"], [121638847, 15, "\u9ed1\u5e2e\u718a\u732b"], [257781092, 14, "\u5a49\u62d2\u4e86_Chris\u7248"], [282006542, 14, "\u6ca1\u4e8b\u558a\u4e00\u558a"], [218429863, 13, "momo"], [191902505, 13, "\u6697\u591c\u730e\u624b"], [281298772, 13, "\u7cca\u7ccamo"], ["I5W2Y0J1314", 11, "momo"], [282998931, 11, "\u8000\u7956"], [280634032, 11, "\u846b\u82a6"], [282355374, 10, "momo"], [258181027, 10, "momo\uff08\u7231\u7248\uff09"], [240837398, 9, "\u4e00\u5757\u94b1"], [194726484, 8, "IT\u968f\u4fbf"], [198529460, 8, "Junn"], [217927735, 8, "momo"], [172421569, 8, "\u4e94\u5cb3\u638c\u95e8\u83ab\u5c0f\u8d1d"], [266668102, 7, "momo"], [259567645, 7, "\u56f0\u56f0\u56f0"], [278364762, 7, "\u6155a"], [4261388, 7, "\u65f6\u95f4\u6d77"], [138445157, 7, "\u8d77\u540d\u5b57\u9ebb\u70e6"], [198543424, 5, "SNH48-\u88f4\u73e0\u6ceb"], [243467287, 5, "\u4e91\u6df1\u4e0d\u77e5\u5904"], [280038437, 5, "\u9e7f\u70b9\u70b9"], [281031349, 4, "WUSU"], [121509113, 4, "momo"], [281150532, 4, "\u5708\u5708\u5706\u5706\u5708\u5708"], [284936825, 4, "\u7c9f\u7c73\u4e0d\u63b0\u68d2\u5b50"], [175170137, 4, "\u88ab\u5b50\u5916\u9762\u592a\u53ef\u6015"], [76012602, 3, "momo"], [193307523, 3, "momo"], [278578104, 3, "\u6211\u662f\u56db\u5ddd\u52d2momo"], [173896254, 2, "momo"], [171879268, 2, "nenr"], [218554448, 2, "\u4e8e\u662f\u98ce\u6765\u8fc7vcr"], [281836247, 2, "\u545c\u5566\u5566"], [81108758, 2, "\u5495\u5495\u5495\u5495"], [226238496, 2, "\u55ef\u5462"], [246011740, 2, "\u60ef\u6027\u53d1\u75af"], [270800859, 2, "\u6211\u6211\u6211"], [269840559, 2, "\u62b1\u4e00\u4e1d\u4f60\u54ea\u4f4d"], [209728967, 2, "\u9ad8\u5c71\u6211\u68a6"], [216340755, 2, "\ud83c\udf38momo\ud83c\udf38"], [239340447, 2, "\ud83d\udee5\ud83c\udf64WERU"], [221399804, 1, "hdhxhjsjhd"], [188564750, 1, "momo"], [174330697, 1, "momo"], [269337258, 1, "momo"], [278262556, 1, "momo"], [229882492, 1, "momo"], [282039851, 1, "momo"], ["guyeqian", 1, "\u4e0d\u5403\u8471\u7684\u987e"], [280148684, 1, "\u5343\u5e06\u8fc7\u5c3d"], [76359961, 1, "\u53cd\u5f39"], [224114431, 1, "\u53f8\u547d"], [60617082, 1, "\u5403\u74dc\u76fc\u4e2d\u5956mo"], [259634442, 1, "\u5409\u5409\u56fd\u738b"], [284525375, 1, "\u5431\u5431\u5431"], [247224595, 1, "\u5c0f\u53ef\u7231"], [279431384, 1, "\u6751\u91cc\u4eba"], [162403012, 1, "\u70b9\u70b9\u70b9"], ["dwdisgoodgirl", 1, "\u725b\u8089\u5e72or\u725b\u677f\u7b4b"], [218451309, 1, "\u752f\u5be7\u5b81love"], [271284098, 1, "\u83cc\u8349"], [184076333, 1, "\u84dd\u9c7c"], [180005241, 1, "\u84e6\u7136"], [213210751, 1, "\u8d39\u96f7"]]}, {"date": "2025-01-02 00:00:00", "rankings": [[212945898, 204, "\u70b9\u89e3\u70b9\u89e3DJ"], [284179257, 193, "MOMO2.0"], [256060645, 137, "0UXDeNA"], [130294434, 129, "\u53f8\u547d\u2601"], [282998964, 100, "\ud80c\udda1\ud80c\udd9d\ud80c\udd9f\ud80c\udd9c\ud80c\udd9e\ud80c\udd9f"], [70348459, 95, "\u4f36\u4ec3\u7ed9\u4f60\u8bfa"], [260295198, 91, "\u5c0f\u624b\u7231\u73a9"], [217927735, 77, "momo"], [261080295, 76, "underdog"], [143523138, 76, "\u5984\u7559WL"], [231193411, 74, "\u5c0f\u5976\u8c46"], ["pixiaodan", 72, "\u516d\u6247\u95e8\u5185\u674e\u94f6\u5fc3"], [278142675, 69, "\u864emo"], [243090410, 58, "momo"], [282006542, 56, "\u6ca1\u4e8b\u558a\u4e00\u558a"], [260322814, 52, "FoFo"], [121638847, 51, "\u9ed1\u5e2e\u718a\u732b"], [189480748, 46, "Nothing"], [275997314, 44, "\u9ea6\u8150\u5224\u5b98"], [282998931, 43, "\u8000\u7956"], [237972257, 43, "\u968f\u610f"], [284411948, 39, "\u597d\u597d\u597d"], [279804730, 37, "momo"], [243467287, 35, "\u4e91\u6df1\u4e0d\u77e5\u5904"], [281298772, 34, "\u7cca\u7ccamo"], [191902505, 29, "\u6697\u591c\u730e\u624b"], [259567645, 27, "\u56f0\u56f0\u56f0"], [218429863, 22, "momo"], [282355374, 22, "momo"], [258181027, 22, "momo\uff08\u7231\u7248\uff09"], [172421569, 18, "\u4e94\u5cb3\u638c\u95e8\u83ab\u5c0f\u8d1d"], [198529460, 15, "Junn"], [76012602, 15, "momo"], [193307523, 15, "momo"], [257781092, 15, "\u5a49\u62d2\u4e86_Chris\u7248"], [280634032, 15, "\u846b\u82a6"], ["I5W2Y0J1314", 14, "momo"], [55557556, 13, "mxmx"], ["ID678678", 12, "\u6ca1\u4e8b\u5c31\u778e\u901b\u5457"], [175170137, 12, "\u88ab\u5b50\u5916\u9762\u592a\u53ef\u6015"], [194726484, 11, "IT\u968f\u4fbf"], [266668102, 11, "momo"], [247224595, 11, "\u5c0f\u53ef\u7231"], [280038437, 11, "\u9e7f\u70b9\u70b9"], [4261388, 10, "\u65f6\u95f4\u6d77"], [240837398, 9, "\u4e00\u5757\u94b1"], [281836247, 9, "\u545c\u5566\u5566"], [198543424, 8, "SNH48-\u88f4\u73e0\u6ceb"], [173896254, 8, "momo"], [278364762, 7, "\u6155a"], [138445157, 7, "\u8d77\u540d\u5b57\u9ebb\u70e6"], [284525375, 6, "\u5431\u5431\u5431"], [149113870, 5, "Joying"], [121509113, 5, "momo"], [269840559, 5, "\u62b1\u4e00\u4e1d\u4f60\u54ea\u4f4d"], [257503170, 5, "\u62b1\u7d27\u6211\u7684\u5357\u74dc\u732b"], [239340447, 5, "\ud83d\udee5\ud83c\udf64WERU"], [281031349, 4, "WUSU"], [278262556, 4, "momo"], [229882492, 4, "momo"], [281150532, 4, "\u5708\u5708\u5706\u5706\u5708\u5708"], [284936825, 4, "\u7c9f\u7c73\u4e0d\u63b0\u68d2\u5b50"], [270191433, 3, "19"], [221399804, 3, "hdhxhjsjhd"], [76359961, 3, "\u53cd\u5f39"], [81108758, 3, "\u5495\u5495\u5495\u5495"], [226238496, 3, "\u55ef\u5462"], [246011740, 3, "\u60ef\u6027\u53d1\u75af"], [278578104, 3, "\u6211\u662f\u56db\u5ddd\u52d2momo"], [174330697, 2, "momo"], [171879268, 2, "nenr"], ["guyeqian", 2, "\u4e0d\u5403\u8471\u7684\u987e"], [218554448, 2, "\u4e8e\u662f\u98ce\u6765\u8fc7vcr"], [224114431, 2, "\u53f8\u547d"], [259634442, 2, "\u5409\u5409\u56fd\u738b"], [270800859, 2, "\u6211\u6211\u6211"], [180005241, 2, "\u84e6\u7136"], [209728967, 2, "\u9ad8\u5c71\u6211\u68a6"], [216340755, 2, "\ud83c\udf38momo\ud83c\udf38"], [154728935, 1, "chechE"], [141874687, 1, "leehyolee"], [188564750, 1, "momo"], [269337258, 1, "momo"], [282039851, 1, "momo"], ["qlllovesheren", 1, "momo"], [204200609, 1, "momo"], [201381571, 1, "\u5143\u65e5"], [280148684, 1, "\u5343\u5e06\u8fc7\u5c3d"], [60617082, 1, "\u5403\u74dc\u76fc\u4e2d\u5956mo"], [272490269, 1, "\u54af\u5654\u59d0"], [77418139, 1, "\u65f6\u5149\u673a\u4e0d\u4f1a\u8001"], [279431384, 1, "\u6751\u91cc\u4eba"], [176472336, 1, "\u6c5f\u6e56\u504f\u5b50"], [264049302, 1, "\u6ca1\u6709\u88ab\u9080\u8bf7"], [162403012, 1, "\u70b9\u70b9\u70b9"], ["dwdisgoodgirl", 1, "\u725b\u8089\u5e72or\u725b\u677f\u7b4b"], [218451309, 1, "\u752f\u5be7\u5b81love"], [281917391, 1, "\u77ed\u77ed\u51e0\u4e2a\u79cb"], [271284098, 1, "\u83cc\u8349"], [184076333, 1, "\u84dd\u9c7c"], [247351870, 1, "\u8c46\u53cbn5tuEdgBYQ"], [213210751, 1, "\u8d39\u96f7"]]}, {"date": "2025-01-03 00:00:00", "rankings": [[212945898, 334, "\u70b9\u89e3\u70b9\u89e3DJ"], [284179257, 302, "MOMO2.0"], [130294434, 216, "\u53f8\u547d\u2601"], [256060645, 171, "0UXDeNA"], [70348459, 163, "\u4f36\u4ec3\u7ed9\u4f60\u8bfa"], [282998964, 144, "\ud80c\udda1\ud80c\udd9d\ud80c\udd9f\ud80c\udd9c\ud80c\udd9e\ud80c\udd9f"], [143523138, 130, "\u5984\u7559WL"], [260295198, 115, "\u5c0f\u624b\u7231\u73a9"], [278142675, 108, "\u864emo"], [231193411, 107, "\u5c0f\u5976\u8c46"], [217927735, 104, "momo"], ["pixiaodan", 102, "\u516d\u6247\u95e8\u5185\u674e\u94f6\u5fc3"], [261080295, 96, "underdog"], [243090410, 91, "momo"], [121638847, 87, "\u9ed1\u5e2e\u718a\u732b"], [282998931, 86, "\u8000\u7956"], [243467287, 77, "\u4e91\u6df1\u4e0d\u77e5\u5904"], [191902505, 77, "\u6697\u591c\u730e\u624b"], [260322814, 64, "FoFo"], [281298772, 59, "\u7cca\u7ccamo"], [237972257, 58, "\u968f\u610f"], [282006542, 57, "\u6ca1\u4e8b\u558a\u4e00\u558a"], [284411948, 56, "\u597d\u597d\u597d"], [279804730, 52, "momo"], [280038437, 52, "\u9e7f\u70b9\u70b9"], [275997314, 52, "\u9ea6\u8150\u5224\u5b98"], [189480748, 50, "Nothing"], [259567645, 50, "\u56f0\u56f0\u56f0"], [76012602, 44, "momo"], [282355374, 39, "momo"], [218429863, 34, "momo"], [258181027, 30, "momo\uff08\u7231\u7248\uff09"], [198529460, 29, "Junn"], ["I5W2Y0J1314", 28, "momo"], [172421569, 27, "\u4e94\u5cb3\u638c\u95e8\u83ab\u5c0f\u8d1d"], [280634032, 23, "\u846b\u82a6"], [193307523, 22, "momo"], [175170137, 22, "\u88ab\u5b50\u5916\u9762\u592a\u53ef\u6015"], [4261388, 19, "\u65f6\u95f4\u6d77"], [183109359, 19, "\u9ec4"], [257781092, 18, "\u5a49\u62d2\u4e86_Chris\u7248"], [55557556, 16, "mxmx"], [284525375, 16, "\u5431\u5431\u5431"], [266668102, 12, "momo"], [121509113, 12, "momo"], [269840559, 12, "\u62b1\u4e00\u4e1d\u4f60\u54ea\u4f4d"], ["ID678678", 12, "\u6ca1\u4e8b\u5c31\u778e\u901b\u5457"], [138445157, 12, "\u8d77\u540d\u5b57\u9ebb\u70e6"], [194726484, 11, "IT\u968f\u4fbf"], [240837398, 11, "\u4e00\u5757\u94b1"], [281836247, 11, "\u545c\u5566\u5566"], [247224595, 11, "\u5c0f\u53ef\u7231"], [173896254, 10, "momo"], [257503170, 9, "\u62b1\u7d27\u6211\u7684\u5357\u74dc\u732b"], [198543424, 8, "SNH48-\u88f4\u73e0\u6ceb"], [278364762, 8, "\u6155a"], [229882492, 7, "momo"], [81108758, 7, "\u5495\u5495\u5495\u5495"], [264049302, 7, "\u6ca1\u6709\u88ab\u9080\u8bf7"], ["guyeqian", 6, "\u4e0d\u5403\u8471\u7684\u987e"], [239340447, 6, "\ud83d\udee5\ud83c\udf64WERU"], [149113870, 5, "Joying"], [281031349, 5, "WUSU"], [278262556, 5, "momo"], [226238496, 5, "\u55ef\u5462"], [284936825, 5, "\u7c9f\u7c73\u4e0d\u63b0\u68d2\u5b50"], [270191433, 4, "19"], [171879268, 4, "nenr"], [281150532, 4, "\u5708\u5708\u5706\u5706\u5708\u5708"], [221399804, 3, "hdhxhjsjhd"], ["qlllovesheren", 3, "momo"], [76359961, 3, "\u53cd\u5f39"], [246011740, 3, "\u60ef\u6027\u53d1\u75af"], [278578104, 3, "\u6211\u662f\u56db\u5ddd\u52d2momo"], [123055616, 3, "\u6c89\u9ed8\u4e0d\u8bed"], [213210751, 3, "\u8d39\u96f7"], [141874687, 2, "leehyolee"], [174330697, 2, "momo"], [218554448, 2, "\u4e8e\u662f\u98ce\u6765\u8fc7vcr"], [224114431, 2, "\u53f8\u547d"], [60617082, 2, "\u5403\u74dc\u76fc\u4e2d\u5956mo"], [259634442, 2, "\u5409\u5409\u56fd\u738b"], [270800859, 2, "\u6211\u6211\u6211"], [281917391, 2, "\u77ed\u77ed\u51e0\u4e2a\u79cb"], [180005241, 2, "\u84e6\u7136"], [209728967, 2, "\u9ad8\u5c71\u6211\u68a6"], [216340755, 2, "\ud83c\udf38momo\ud83c\udf38"], [183092185, 1, "123456\u4e00\u8d77\u8d70"], [179256802, 1, "AKA\u6b66\u796f"], [154728935, 1, "chechE"], [188564750, 1, "momo"], [269337258, 1, "momo"], [282039851, 1, "momo"], [204200609, 1, "momo"], [44314224, 1, "\u1dc4\u0847\u1dc5"], [126046846, 1, "\u4e07\u91cc\u9ad8"], [201381571, 1, "\u5143\u65e5"], [251900211, 1, "\u521a\u67d4\u5e76\u6d4e"], [280148684, 1, "\u5343\u5e06\u8fc7\u5c3d"], ["saaaa1984", 1, "\u53bb\u53bb\u5c31\u56de1120"], [272490269, 1, "\u54af\u5654\u59d0"], [259654496, 1, "\u60f3\u529e\u6cd5\u517b\u8fea\u5df4"], [77418139, 1, "\u65f6\u5149\u673a\u4e0d\u4f1a\u8001"], [279431384, 1, "\u6751\u91cc\u4eba"], [176472336, 1, "\u6c5f\u6e56\u504f\u5b50"], [162403012, 1, "\u70b9\u70b9\u70b9"], ["dwdisgoodgirl", 1, "\u725b\u8089\u5e72or\u725b\u677f\u7b4b"], [218451309, 1, "\u752f\u5be7\u5b81love"], [278394177, 1, "\u767d\u571f"], [271284098, 1, "\u83cc\u8349"], [184076333, 1, "\u84dd\u9c7c"], [247351870, 1, "\u8c46\u53cbn5tuEdgBYQ"]]}, {"date": "2025-01-04 00:00:00", "rankings": [[212945898, 334, "\u70b9\u89e3\u70b9\u89e3DJ"], [284179257, 304, "MOMO2.0"], [130294434, 224, "\u53f8\u547d\u2601"], [256060645, 172, "0UXDeNA"], [70348459, 167, "\u4f36\u4ec3\u7ed9\u4f60\u8bfa"], [282998964, 145, "\ud80c\udda1\ud80c\udd9d\ud80c\udd9f\ud80c\udd9c\ud80c\udd9e\ud80c\udd9f"], [143523138, 130, "\u5984\u7559WL"], [260295198, 115, "\u5c0f\u624b\u7231\u73a9"], ["pixiaodan", 111, "\u516d\u6247\u95e8\u5185\u674e\u94f6\u5fc3"], [231193411, 110, "\u5c0f\u5976\u8c46"], [278142675, 108, "\u864emo"], [261080295, 105, "underdog"], [217927735, 104, "momo"], [243090410, 92, "momo"], [282998931, 88, "\u8000\u7956"], [121638847, 88, "\u9ed1\u5e2e\u718a\u732b"], [191902505, 84, "\u6697\u591c\u730e\u624b"], [243467287, 77, "\u4e91\u6df1\u4e0d\u77e5\u5904"], [260322814, 72, "FoFo"], [237972257, 61, "\u968f\u610f"], [281298772, 60, "\u7cca\u7ccamo"], [284411948, 58, "\u597d\u597d\u597d"], [282006542, 57, "\u6ca1\u4e8b\u558a\u4e00\u558a"], [259567645, 54, "\u56f0\u56f0\u56f0"], [280038437, 53, "\u9e7f\u70b9\u70b9"], [275997314, 53, "\u9ea6\u8150\u5224\u5b98"], [279804730, 52, "momo"], [189480748, 50, "Nothing"], [76012602, 44, "momo"], [282355374, 43, "momo"], [218429863, 36, "momo"], [258181027, 34, "momo\uff08\u7231\u7248\uff09"], ["I5W2Y0J1314", 30, "momo"], [198529460, 29, "Junn"], [172421569, 27, "\u4e94\u5cb3\u638c\u95e8\u83ab\u5c0f\u8d1d"], [280634032, 23, "\u846b\u82a6"], [193307523, 22, "momo"], [175170137, 22, "\u88ab\u5b50\u5916\u9762\u592a\u53ef\u6015"], [257781092, 19, "\u5a49\u62d2\u4e86_Chris\u7248"], [4261388, 19, "\u65f6\u95f4\u6d77"], [183109359, 19, "\u9ec4"], [240837398, 18, "\u4e00\u5757\u94b1"], [55557556, 16, "mxmx"], [284525375, 16, "\u5431\u5431\u5431"], [266668102, 12, "momo"], [121509113, 12, "momo"], [269840559, 12, "\u62b1\u4e00\u4e1d\u4f60\u54ea\u4f4d"], ["ID678678", 12, "\u6ca1\u4e8b\u5c31\u778e\u901b\u5457"], [138445157, 12, "\u8d77\u540d\u5b57\u9ebb\u70e6"], [194726484, 11, "IT\u968f\u4fbf"], [281836247, 11, "\u545c\u5566\u5566"], [247224595, 11, "\u5c0f\u53ef\u7231"], [173896254, 10, "momo"], [278364762, 9, "\u6155a"], [257503170, 9, "\u62b1\u7d27\u6211\u7684\u5357\u74dc\u732b"], [198543424, 8, "SNH48-\u88f4\u73e0\u6ceb"], [278262556, 7, "momo"], [229882492, 7, "momo"], [81108758, 7, "\u5495\u5495\u5495\u5495"], [264049302, 7, "\u6ca1\u6709\u88ab\u9080\u8bf7"], ["guyeqian", 6, "\u4e0d\u5403\u8471\u7684\u987e"], [239340447, 6, "\ud83d\udee5\ud83c\udf64WERU"], [149113870, 5, "Joying"], [281031349, 5, "WUSU"], [226238496, 5, "\u55ef\u5462"], [284936825, 5, "\u7c9f\u7c73\u4e0d\u63b0\u68d2\u5b50"], [270191433, 4, "19"], [171879268, 4, "nenr"], [281150532, 4, "\u5708\u5708\u5706\u5706\u5708\u5708"], [221399804, 3, "hdhxhjsjhd"], ["qlllovesheren", 3, "momo"], [76359961, 3, "\u53cd\u5f39"], [246011740, 3, "\u60ef\u6027\u53d1\u75af"], [278578104, 3, "\u6211\u662f\u56db\u5ddd\u52d2momo"], [123055616, 3, "\u6c89\u9ed8\u4e0d\u8bed"], [213210751, 3, "\u8d39\u96f7"], [141874687, 2, "leehyolee"], [174330697, 2, "momo"], [218554448, 2, "\u4e8e\u662f\u98ce\u6765\u8fc7vcr"], [224114431, 2, "\u53f8\u547d"], [60617082, 2, "\u5403\u74dc\u76fc\u4e2d\u5956mo"], [259634442, 2, "\u5409\u5409\u56fd\u738b"], [270800859, 2, "\u6211\u6211\u6211"], [281917391, 2, "\u77ed\u77ed\u51e0\u4e2a\u79cb"], [180005241, 2, "\u84e6\u7136"], [209728967, 2, "\u9ad8\u5c71\u6211\u68a6"], [216340755, 2, "\ud83c\udf38momo\ud83c\udf38"], [183092185, 1, "123456\u4e00\u8d77\u8d70"], [179256802, 1, "AKA\u6b66\u796f"], [154728935, 1, "chechE"], [188564750, 1, "momo"], [269337258, 1, "momo"], [282039851, 1, "momo"], [204200609, 1, "momo"], [44314224, 1, "\u1dc4\u0847\u1dc5"], [126046846, 1, "\u4e07\u91cc\u9ad8"], [201381571, 1, "\u5143\u65e5"], [251900211, 1, "\u521a\u67d4\u5e76\u6d4e"], [280148684, 1, "\u5343\u5e06\u8fc7\u5c3d"], ["saaaa1984", 1, "\u53bb\u53bb\u5c31\u56de1120"], [272490269, 1, "\u54af\u5654\u59d0"], [259654496, 1, "\u60f3\u529e\u6cd5\u517b\u8fea\u5df4"], [77418139, 1, "\u65f6\u5149\u673a\u4e0d\u4f1a\u8001"], [279431384, 1, "\u6751\u91cc\u4eba"], [176472336, 1, "\u6c5f\u6e56\u504f\u5b50"], [162403012, 1, "\u70b9\u70b9\u70b9"], ["dwdisgoodgirl", 1, "\u725b\u8089\u5e72or\u725b\u677f\u7b4b"], [218451309, 1, "\u752f\u5be7\u5b81love"], [278394177, 1, "\u767d\u571f"], [271284098, 1, "\u83cc\u8349"], [184076333, 1, "\u84dd\u9c7c"], [247351870, 1, "\u8c46\u53cbn5tuEdgBYQ"]]}];
        let currentIndex = 0;
        let animationInterval;
        let chart;
        let previousRankings = new Map();
        let currentCounts = new Map();
        let targetIndex = 0;
        let animationSpeed = 2; // æ¯æ¬¡å¢åŠ 1æ¡
        let totalCounts = new Map(); // å­˜å‚¨æ¯ä¸ªæ—¥æœŸçš„ç›®æ ‡å‘è¨€æ€»æ•°
        let uidToLatestUserId = new Map(); // å­˜å‚¨UIDåˆ°æœ€æ–°User IDçš„æ˜ å°„
        let animate; // å£°æ˜åœ¨å…¨å±€ä½œç”¨åŸŸ
        let podiumClosed = false;  // æ·»åŠ æ ‡å¿—æ¥è¿½è¸ªé¢å¥–å°çŠ¶æ€
        let autoCloseTimer = null;  // ç”¨äºå­˜å‚¨è‡ªåŠ¨å…³é—­çš„å®šæ—¶å™¨
        
        // æ£€æŸ¥å¤´åƒæ˜¯å¦å­˜åœ¨
        async function checkImageExists(uid) {
            try {
                const response = await fetch(`file:///Users/Elias/Documents/è±†ç“£é«˜æ¥¼/å¹´ç»ˆ/avatar/${uid}.jpg`);
                return response.ok;
            } catch (e) {
                console.log(`Avatar not found for UID: ${uid}`);
                return false;
            }
        }

        // åˆå§‹åŒ–æ¯ä¸ªæ—¥æœŸçš„ç›®æ ‡å‘è¨€æ€»æ•°
        function initTotalCounts() {
            rankingsData.forEach(dayData => {
                const date = dayData.date.split(' ')[0];
                const totals = new Map();
                dayData.rankings.forEach(([uid, count, user_id]) => {
                    totals.set(uid, count);
                    // æ›´æ–°ç”¨æˆ·IDæ˜ å°„
                    uidToLatestUserId.set(uid, user_id);
                });
                totalCounts.set(date, totals);
            });
        }

        async function initChart() {
            const ctx = document.getElementById('rankingChart').getContext('2d');
            
            // åˆ›å»ºè‡ªå®šä¹‰æ’ä»¶æ¥ç»˜åˆ¶å¤´åƒ
            const avatarPlugin = {
                id: 'avatarPlugin',
                afterDatasetsDraw: (chart) => {
                    const {ctx, scales: {x, y}} = chart;
                    
                    for (let index = 0; index < chart.data.labels.length; index++) {
                        const uid = chart.data.uids[index];
                        if (!chart.avatarCache) {
                            chart.avatarCache = new Map();
                        }
                        
                        if (!chart.avatarCache.has(uid)) {
                            const img = new Image();
                            img.src = `/avatar/${uid}.jpg`;
                            chart.avatarCache.set(uid, img);
                        }
                        
                        const img = chart.avatarCache.get(uid);
                        if (img.complete && img.naturalHeight !== 0) {
                            const xPos = x.getPixelForValue(chart.data.datasets[0].data[index]);
                            const yPos = y.getPixelForValue(index);
                            
                            const avatarSize = 30;     // å¤´åƒå¤§å°
                            const xOffset = -25;       // è´Ÿåç§»é‡
                            
                            // åœ¨ç»˜åˆ¶å¤´åƒä¹‹å‰ä¿å­˜å½“å‰ç»˜å›¾ä¸Šä¸‹æ–‡çŠ¶æ€
                            ctx.save();
                            
                            // è®¾ç½®å…¨å±€åˆæˆæ“ä½œï¼Œç¡®ä¿å¤´åƒåœ¨æŸ±çŠ¶å›¾ä¸Šæ–¹
                            ctx.globalCompositeOperation = 'source-over';
                            
                            // åˆ›å»ºåœ†å½¢è£å‰ªè·¯å¾„
                            ctx.beginPath();
                            ctx.arc(
                                xPos + xOffset,        // X ä½ç½®
                                yPos,                  // Y ä½ç½®
                                avatarSize/2, 
                                0, 
                                Math.PI * 2
                            );
                            ctx.closePath();
                            ctx.clip();
                            
                            // ç»˜åˆ¶å¤´åƒ
                            ctx.drawImage(
                                img, 
                                xPos + xOffset - avatarSize/2,  // X ä½ç½®
                                yPos - avatarSize/2,            // Y ä½ç½®
                                avatarSize,                     // å®½åº¦
                                avatarSize                      // é«˜åº¦
                            );
                            
                            // æ¢å¤ç»˜å›¾ä¸Šä¸‹æ–‡çŠ¶æ€
                            ctx.restore();
                            
                            // å¯é€‰ï¼šæ·»åŠ å¤´åƒè¾¹æ¡†
                            ctx.beginPath();
                            ctx.arc(
                                xPos + xOffset,
                                yPos,
                                avatarSize/2,
                                0,
                                Math.PI * 2
                            );
                            ctx.strokeStyle = 'white';  // è¾¹æ¡†é¢œè‰²
                            ctx.lineWidth = 2;          // è¾¹æ¡†å®½åº¦
                            ctx.stroke();
                        }
                    }
                }
            };

            chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: [],
                    uids: [],
                    datasets: [{
                        label: 'ç´¯è®¡ç›–æ¥¼æ•°',
                        data: [],
                        backgroundColor: function(context) {
                            const index = context.dataIndex;
                            switch(index) {
                                case 0: return 'rgba(255, 215, 0, 0.8)';
                                case 1: return 'rgba(192, 192, 192, 0.8)';
                                case 2: return 'rgba(205, 127, 50, 0.8)';
                                default: return 'rgba(30, 136, 229, 0.8)';
                            }
                        },
                        borderColor: function(context) {
                            const index = context.dataIndex;
                            switch(index) {
                                case 0: return 'rgba(255, 215, 0, 1)';
                                case 1: return 'rgba(192, 192, 192, 1)';
                                case 2: return 'rgba(205, 127, 50, 1)';
                                default: return 'rgba(30, 136, 229, 1)';
                            }
                        },
                        borderWidth: 1,
                        borderRadius: 6
                    }]
                },
                options: {
                    indexAxis: 'y',
                    animation: {
                        duration: 1000,
                        easing: 'easeInOutQuart'
                    },
                    layout: {
                        padding: {
                            right: 100 // ä¸ºå¤´åƒç•™å‡ºç©ºé—´
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            max:500,//æ¨ªå‘æœ€å¤§å€¼ï¼Œä»¥æ­¤ç›¸å¯¹ç¼©çŸ­æŸ±çŠ¶é•¿åº¦
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: function(context) {
                                    const index = context.index;
                                    switch(index) {
                                        case 0: 
                                            return {
                                                size: 22,
                                                weight: 'bold',
                                                family: 'Arial'
                                            };
                                        case 1:
                                            return {
                                                size: 20,
                                                weight: 'bold',
                                                family: 'Arial'
                                            };
                                        case 2:
                                            return {
                                                size: 18,
                                                weight: 'bold',
                                                family: 'Arial'
                                            };
                                        default:
                                            return {
                                                size: 16,
                                                weight: 'normal',
                                                family: 'Arial'
                                            };
                                    }
                                },
                                color: function(context) {
                                    const index = context.index;
                                    switch(index) {
                                        case 0: return '#FFD700';
                                        case 1: return '#C0C0C0';
                                        case 2: return '#CD7F32';
                                        default: return '#444';
                                    }
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        datalabels: {
                            anchor: 'end',
                            align: 'right',
                            offset: 15,
                            color: function(context) {
                                const index = context.dataIndex;
                                // ä¸ºå‰ä¸‰åè®¾ç½®ç‰¹æ®Šé¢œè‰²
                                switch(index) {
                                    case 0: return '#FFD700'; // é‡‘è‰²
                                    case 1: return '#C0C0C0'; // é“¶è‰²
                                    case 2: return '#CD7F32'; // é“œè‰²
                                    default: return '#444';
                                }
                            },
                            font: {
                                size: 16,
                                weight: 'bold'
                            },
                            formatter: (value) => Math.floor(value)
                        }
                    },
                    maintainAspectRatio: false,
                    transitions: {
                        active: {
                            animation: {
                                duration: 1000
                            }
                        }
                    }
                },
                plugins: [ChartDataLabels, avatarPlugin]
            });
            return chart;
        }

        function updateChart() {
            const currentDate = rankingsData[targetIndex].date.split(' ')[0];
            const targetTotals = totalCounts.get(currentDate);
            let allReached = true;
            let dataChanged = false;

            // æŒç»­å¢åŠ æ¯ä¸ªç”¨æˆ·çš„è®¡æ•°
            for (const [uid, targetCount] of targetTotals) {
                if (!currentCounts.has(uid)) {
                    currentCounts.set(uid, 0);
                    dataChanged = true;
                }
                
                const current = currentCounts.get(uid);
                if (current < targetCount) {
                    currentCounts.set(uid, Math.min(current + 1, targetCount));
                    dataChanged = true;
                    allReached = false;
                }
            }

            // åªåœ¨æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶æ›´æ–°å›¾è¡¨
            if (dataChanged) {
                const sortedUsers = Array.from(currentCounts.entries())
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 10);

                const labels = sortedUsers.map(([uid]) => uidToLatestUserId.get(uid) || uid);
                const uids = sortedUsers.map(([uid]) => uid);
                const data = sortedUsers.map(([, count]) => Math.floor(count));

                // æ›´æ–°å›¾è¡¨æ•°æ®
                chart.data.labels = labels;
                chart.data.uids = uids;
                chart.data.datasets[0].data = data;

                document.getElementById('dateLabel').textContent = currentDate;
                chart.update('none');
                previousRankings = new Map(uids.map((uid, i) => [uid, i]));
            }

            // æ£€æŸ¥æ˜¯å¦æ˜¯æœ€åä¸€å¤©ä¸”æ‰€æœ‰æ•°æ®éƒ½è¾¾åˆ°ç›®æ ‡
            const isLastDay = targetIndex === rankingsData.length - 1;
            if (isLastDay && allReached && !podiumClosed) {
                setTimeout(showPodium, 300);
            }

            // å¦‚æœæ‰€æœ‰ç”¨æˆ·éƒ½è¾¾åˆ°å½“æ—¥ç›®æ ‡ï¼Œè¿›å…¥ä¸‹ä¸€å¤©
            if (allReached && targetIndex < rankingsData.length - 1) {
                targetIndex++;
            }

            // æ§åˆ¶åŠ¨ç”»é€Ÿåº¦
            setTimeout(() => {
                if (animationInterval) {
                    requestAnimationFrame(animate);
                }
            }, 20);
        }

        function startAnimation() {
            if (!animationInterval) {
                animate = () => {
                    updateChart();
                };
                
                animationInterval = true;
                requestAnimationFrame(animate);
            }
        }

        function pauseAnimation() {
            animationInterval = false;
        }

        function resetAnimation() {
            currentIndex = 0;
            targetIndex = 0;
            currentCounts = new Map();
            previousRankings = new Map();
            podiumClosed = false;  // é‡ç½®å…³é—­æ ‡å¿—
            // ç¡®ä¿é¢å¥–å°è¢«éšè—
            document.querySelector('.podium-overlay').style.display = 'none';
            if (animationInterval) {
                pauseAnimation();
            }
            updateChart();
        }

        // æ­£ç¡®çš„åˆå§‹åŒ–é¡ºåº
        async function initialize() {
            initTotalCounts();
            await initChart();
            updateChart();
            // åˆå§‹åŒ–æ—¶æ˜¾ç¤ºåˆå§‹æ•°æ®
            chart.update();
        }
        
        initialize();

        function shootConfetti() {
            return confetti({
                particleCount: 20,  // å¢åŠ ç²’å­æ•°é‡
                origin: {
                    x: 0.5,
                    y: 0.5
                },
                colors: [
                    '#FFD700',  // é‡‘è‰²
                    '#FF69B4',  // ç²‰çº¢è‰²
                    '#FFE4B5',  // æ·¡é‡‘è‰²
                    '#FFFFFF',  // ç™½è‰²
                    '#87CEEB',  // å¤©è“è‰²
                    '#98FB98',  // æµ…ç»¿è‰²
                    '#E6E6FA',  // æ·¡ç´«è‰²
                ],
                gravity: 0.7,
                scalar: 1.5,
                shapes: ["circle", "square", "star"],
                disableForReducedMotion: true,
                angle: 90,
                startVelocity: 45,  // å¢åŠ åˆå§‹é€Ÿåº¦
                decay: 0.9,
                spread: 150  // å¢åŠ æ‰©æ•£èŒƒå›´
            });
        }

        function startConfettiShow() {
            // å‘å°„ä¸€æ¬¡ç¤¼èŠ±ï¼Œå¹¶åœ¨å®Œæˆåæ¸…ç†
            const promise = shootConfetti();
            
            // ç­‰å¾…ç¤¼èŠ±åŠ¨ç”»å®Œæˆ
            promise.then(() => {
                // æ¸…ç†æ‰€æœ‰ç¤¼èŠ±ç›¸å…³çš„ canvas
                const canvases = document.querySelectorAll('canvas[style*="pointer-events: none"]');
                canvases.forEach(canvas => canvas.remove());
            });
        }

        function closePodium() {
            // å¦‚æœå·²ç»å…³é—­ï¼Œä¸é‡å¤æ‰§è¡Œ
            if (podiumClosed) return;
            
            const overlay = document.querySelector('.podium-overlay');
            overlay.classList.add('fade-out');
            
            setTimeout(() => {
                overlay.style.display = 'none';
                overlay.classList.remove('fade-out');
                
                // æ˜¾ç¤ºå¥–æ¯æŒ‰é’®
                const awardButton = document.querySelector('.award-button');
                awardButton.style.display = 'block';
            }, 500);
            
            podiumClosed = true;
            
            // æ¸…é™¤è‡ªåŠ¨å…³é—­å®šæ—¶å™¨
            if (autoCloseTimer) {
                clearTimeout(autoCloseTimer);
                autoCloseTimer = null;
            }
        }

        function showPodium(fromTrophy = false) {
            // å¦‚æœæ˜¯é¦–æ¬¡æ˜¾ç¤ºä¸”é¢å¥–å°å·²å…³é—­ï¼Œåˆ™è¿”å›
            if (!fromTrophy && podiumClosed) {
                return;
            }
            
            console.log("Showing podium...");
            
            // æ¸…é™¤ä»»ä½•ç°æœ‰çš„è‡ªåŠ¨å…³é—­å®šæ—¶å™¨
            if (autoCloseTimer) {
                clearTimeout(autoCloseTimer);
                autoCloseTimer = null;
            }
            
            const winners = Array.from(currentCounts.entries())
                .sort((a, b) => b[1] - a[1])
                .slice(0, 3);
            
            const overlay = document.querySelector('.podium-overlay');
            
            // é‡ç½®é¢å¥–å°çŠ¶æ€
            podiumClosed = false;
            
            // è®¾ç½®è·å¥–è€…ä¿¡æ¯
            winners.forEach((winner, index) => {
                const [uid, score] = winner;
                const step = document.querySelector(`.${['gold', 'silver', 'bronze'][index]}`);
                const avatar = step.querySelector('.winner-avatar');
                const name = step.querySelector('.winner-name');
                const scoreEl = step.querySelector('.winner-score');
                
                avatar.src = `/avatar/${uid}.jpg`;
                name.textContent = uidToLatestUserId.get(uid);
                scoreEl.textContent = `ç›–æ¥¼ ${Math.floor(score)} å±‚`;
            });
            
            // æ˜¾ç¤ºé¢å¥–å°
            overlay.style.display = 'flex';
            
            // åªåœ¨é¦–æ¬¡æ˜¾ç¤ºæ—¶æ’­æ”¾ç¤¼èŠ±å’Œè®¾ç½®è‡ªåŠ¨å…³é—­
            if (!fromTrophy) {
                setTimeout(() => {
                    startConfettiShow();
                }, 500);
                
                // 10ç§’åè‡ªåŠ¨å…³é—­é¢å¥–å°
                autoCloseTimer = setTimeout(() => {
                    if (!podiumClosed) {
                        closePodium();
                    }
                }, 10000);
            }
        }

        // ä¸ºå¥–æ¯æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶
        document.querySelector('.award-button').addEventListener('click', function(e) {
            e.preventDefault();  // é˜²æ­¢äº‹ä»¶å†’æ³¡
            console.log("Trophy button clicked");
            showPodium(true);
        });

        // ä¿®æ”¹å…³é—­æŒ‰é’®äº‹ä»¶
        document.querySelector('.close-podium').addEventListener('click', function(e) {
            e.preventDefault();  // é˜²æ­¢äº‹ä»¶å†’æ³¡
            closePodium();
        });
    </script>
</body>
</html>
